{% load static %}
<!doctype html>
<html lang="en">
<title>MainRecords</title>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.84.0">
  <title>Sign in Contracts</title>
  <meta charset="UTF-8">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
  <!-- MDB -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/8.1.0/mdb.min.css" rel="stylesheet" />
  <link href="{% static 'bootstrap/dist/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'signin.css' %}" rel="stylesheet">
  <script defer src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script defer type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/8.1.0/mdb.umd.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js"></script>
  <script defer src="{% static 'fontawsome/css/all.min.js' %}"></script>

</head>
<style>
  .toast {
    border: none;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    opacity: 0.7;
  }

  .toast-header {
    border-bottom: none;
  }

  .toast-body {
    font-size: 1rem;

  }
</style>

<body class="text-center">

  <main class="form-signin">
    <form method="POST" id="loginForm">
      {% csrf_token %}
      <img class="mb-4 text-center" src="{% static 'images/EWALogo.png' %}" alt="EWALogo" style="width:300px;">
      <h1 class="h3 mb-3 fw-normal">Please sign in</h1>

      <div class="form-floating">
        <input type="text" class="form-control" name="username" placeholder="CPR">
        <label for="username">CPR</label>
      </div>
      <div class="form-floating">
        <input type="password" class="form-control mt-4" name="password" placeholder="Password">
        <label for="password">Password</label>
      </div>
      <button class="w-100 btn btn-lg btn-primary mt-2" type="submit" id="submitButton">
        <span id="buttonText">Sign in</span>
        <span id="spinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
      </button>
      <div class="row mb-4">
        <div class="col-md-12 d-flex justify-content-center mt-4">
          <!-- Simple link -->
          <a href="{% url 'signup' %}">Don't Have Account?</a>
        </div>
      </div>
      <p class="mt-5 mb-3 text-muted">Mohamed Rajab</p>
    </form>
  </main>

  {% if messages %}
  {% for message in messages %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toastEl = document.getElementById('successToast');
      const toastBody = toastEl.querySelector('.toast-body');
      toastBody.textContent = '{{ message }}';  // Insert the message content
      const toast = new bootstrap.Toast(toastEl);  // Initialize the toast
      toast.show();  // Show the toast
    });
  </script>
  {% endfor %}
  {% endif %}
  <!-- Toast container -->
  <div aria-live="polite" aria-atomic="true" class="position-relative">
    <div class="toast-container position-fixed top-0 end-0 p-3">
      <!-- Success Toast -->
      <div id="successToast" class="toast bg-success text-white" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
          <strong class="me-auto">Success</strong>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
          <!-- Message content will be inserted here -->
        </div>
      </div>
    </div>
  </div>
  <script>
    document.getElementById('loginForm').addEventListener('submit', function (event) {
      // Prevent the default form submission
      event.preventDefault();

      // Disable the submit button to prevent multiple clicks
      const submitButton = document.getElementById('submitButton');
      submitButton.disabled = true;

      // Show the spinner
      const spinner = document.getElementById('spinner');
      spinner.classList.remove('d-none');

      // Change the button text (optional)
      const buttonText = document.getElementById('buttonText');
      buttonText.textContent = 'Signing in...';

      // Submit the form programmatically
      this.submit();
    });
  </script>
</body>

</html>